<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CHARMM CUDA: Uniform distribution scalar conversion functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CHARMM CUDA
   </div>
   <div id="projectbrief">CHARMM cuda development</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Uniform distribution scalar conversion functions</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file provides some simple functions that can be used to convert integers of various widths to floats and doubles with various characteristics.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gafc96ad616364743e209c836450cc4107"><td class="memTemplParams" colspan="2">template&lt;typename Ftype , typename Itype &gt; </td></tr>
<tr class="memitem:gafc96ad616364743e209c836450cc4107"><td class="memTemplItemLeft" align="right" valign="top">R123_CUDA_DEVICE R123_STATIC_INLINE Ftype&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__uniform.html#gafc96ad616364743e209c836450cc4107">r123::u01</a> (Itype in)</td></tr>
<tr class="memdesc:gafc96ad616364743e209c836450cc4107"><td class="mdescLeft">&#160;</td><td class="mdescRight">Input is a W-bit integer (signed or unsigned).  <a href="group__uniform.html#gafc96ad616364743e209c836450cc4107">More...</a><br /></td></tr>
<tr class="separator:gafc96ad616364743e209c836450cc4107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49eb4e2f3522f1b5e22b66bdc86345ce"><td class="memTemplParams" colspan="2">template&lt;typename Ftype , typename Itype &gt; </td></tr>
<tr class="memitem:ga49eb4e2f3522f1b5e22b66bdc86345ce"><td class="memTemplItemLeft" align="right" valign="top">R123_CUDA_DEVICE R123_STATIC_INLINE Ftype&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__uniform.html#ga49eb4e2f3522f1b5e22b66bdc86345ce">r123::uneg11</a> (Itype in)</td></tr>
<tr class="memdesc:ga49eb4e2f3522f1b5e22b66bdc86345ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a signed value in [-1,1].  <a href="group__uniform.html#ga49eb4e2f3522f1b5e22b66bdc86345ce">More...</a><br /></td></tr>
<tr class="separator:ga49eb4e2f3522f1b5e22b66bdc86345ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d75b90f162a67226c8044c6f3198b96"><td class="memTemplParams" colspan="2">template&lt;typename Ftype , typename Itype &gt; </td></tr>
<tr class="memitem:ga6d75b90f162a67226c8044c6f3198b96"><td class="memTemplItemLeft" align="right" valign="top">R123_CUDA_DEVICE R123_STATIC_INLINE Ftype&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__uniform.html#ga6d75b90f162a67226c8044c6f3198b96">r123::u01fixedpt</a> (Itype in)</td></tr>
<tr class="memdesc:ga6d75b90f162a67226c8044c6f3198b96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a value in (0,1) chosen from a set of equally spaced fixed-point values.  <a href="group__uniform.html#ga6d75b90f162a67226c8044c6f3198b96">More...</a><br /></td></tr>
<tr class="separator:ga6d75b90f162a67226c8044c6f3198b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This file provides some simple functions that can be used to convert integers of various widths to floats and doubles with various characteristics. </p>
<p>It can be used to generate real-valued, uniformly distributed random variables from the random integers produced by the Random123 CBRNGs.</p>
<p>There are three templated functions:</p>
<ul>
<li>u01: output is as dense as possible in (0,1}, never 0.0. May return 1.0 if and only if the number of output mantissa bits is less than the width of the input.</li>
<li>uneg11: output is as dense as possible in {-1,1}, never 0.0. May return 1.0 or -1.0 if and only if the number of output mantissa bits is less than the width of the input.</li>
<li>u01fixedpt: output is "fixed point", equispaced, open at both ends, and is never 0.0, 0.5 nor 1.0.</li>
</ul>
<p>The behavior of u01 and uneg11 depend on the pre-processor symbol: R123_UNIFORM_FLOAT_STORE. When #defined to a non-zero value, u01 and uneg11 declare a volatile intermediate result, with the intention of forcing architectures that have "extra bits" in their floating point registers to more closely conform to IEEE arithmetic. When compiled this way, u01 and uneg11 will be significantly slower, as they will incur a memory write and read on every call. Without it, they may fail the "known answer test" implemented in ut_uniform_IEEEkat.cpp even though they perform perfectly reasonable int to float conversions. We have used this option to get 32-bit x86 to produce the same results as 64-bit x86-64 code, but we do not recommend it for normal use.</p>
<p>Three additional functions are defined when C++11 or newer is in use:</p>
<ul>
<li>u01all</li>
<li>uneg11all</li>
<li>u01fixedptall</li>
</ul>
<p>These functions apply the corresponding conversion to every element of their argument, which must be a staticly sized array, e.g., an r123array or a std::array of an integer type.</p>
<p>This file may not be as portable, and has not been tested as rigorously as other files in the library, e.g., the generators. Nevertheless, we hope it is useful and we encourage developers to copy it and modify it for their own use. We invite comments and improvements. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gafc96ad616364743e209c836450cc4107"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafc96ad616364743e209c836450cc4107">&sect;&nbsp;</a></span>u01()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ftype , typename Itype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R123_CUDA_DEVICE R123_STATIC_INLINE Ftype r123::u01 </td>
          <td>(</td>
          <td class="paramtype">Itype&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Input is a W-bit integer (signed or unsigned). </p>
<p>Return a uniform real value in (0, 1] It is cast to a W-bit unsigned integer, multiplied by Ftype(2^-W) and added to Ftype(2^(-W-1)). A good compiler should optimize it down to an int-to-float conversion followed by a multiply and an add, which might be fused, depending on the architecture.</p>
<p>If the input is a uniformly distributed integer, and if Ftype arithmetic follows IEEE754 round-to-nearest rules, then the result is a uniformly distributed floating point number in (0, 1].</p>
<ul>
<li>The result is never exactly 0.0.</li>
<li>The smallest value returned is 2^-(W-1).</li>
<li>Let M be the number of mantissa bits in Ftype (typically 24 or 53).<ul>
<li>If W&gt;M then the largest value retured is 1.0.</li>
<li>If W&lt;=M then the largest value returned is Ftype(1.0 - 2^(-W-1)). </li>
</ul>
</li>
</ul>

</div>
</div>
<a id="ga6d75b90f162a67226c8044c6f3198b96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6d75b90f162a67226c8044c6f3198b96">&sect;&nbsp;</a></span>u01fixedpt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ftype , typename Itype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R123_CUDA_DEVICE R123_STATIC_INLINE Ftype r123::u01fixedpt </td>
          <td>(</td>
          <td class="paramtype">Itype&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a value in (0,1) chosen from a set of equally spaced fixed-point values. </p>
<p>Let:</p><ul>
<li>W = width of Itype, e.g., 32 or 64, regardless of signedness.</li>
<li>M = mantissa bits of Ftype, e.g., 24, 53 or 64</li>
<li>B = min(M, W)</li>
</ul>
<p>Then the 2^(B-1) possible output values are: 2^-B*{1, 3, 5, ..., 2^B - 1}</p>
<p>The smallest output is: 2^-B</p>
<p>The largest output is: 1 - 2^-B</p>
<p>The output is never exactly 0.0, nor 0.5, nor 1.0.</p>
<p>The 2^(B-1) possible outputs:</p><ul>
<li>are equally likely,</li>
<li>are uniformly spaced by 2^-(B-1),</li>
<li>are balanced around 0.5 </li>
</ul>

</div>
</div>
<a id="ga49eb4e2f3522f1b5e22b66bdc86345ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49eb4e2f3522f1b5e22b66bdc86345ce">&sect;&nbsp;</a></span>uneg11()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Ftype , typename Itype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">R123_CUDA_DEVICE R123_STATIC_INLINE Ftype r123::uneg11 </td>
          <td>(</td>
          <td class="paramtype">Itype&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a signed value in [-1,1]. </p>
<p>The argument is converted to a W-bit signed integer, multiplied by Ftype(2^-(W-1)) and then added to Ftype(2^-W). A good compiler should optimize it down to an int-to-float conversion followed by a multiply and an add, which might be fused, depending on the architecture.</p>
<p>If the input is a uniformly distributed integer, and if Ftype arithmetic follows IEEE754 round-to-nearest rules, then the output is a uniformly distributed floating point number in [-1, 1].</p>
<ul>
<li>The result is never exactly 0.0.</li>
<li>The smallest absolute value returned is 2^-W</li>
<li>Let M be the number of mantissa bits in Ftype.<ul>
<li>If W&gt;M then the largest value retured is 1.0 and the smallest is -1.0.</li>
<li>If W&lt;=M then the largest value returned is the Ftype(1.0 - 2^-W) and the smallest value returned is -Ftype(1.0 - 2^-W). </li>
</ul>
</li>
</ul>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
